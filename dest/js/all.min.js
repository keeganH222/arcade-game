"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}!function(){var s={},i=[];function t(e){if(s[e])return s[e];var t=new Image;t.onload=function(){s[e]=t,n()&&i.forEach(function(e){e()})},s[e]=!1,t.src=e}function n(){var e=!0;for(var t in s)s.hasOwnProperty(t)&&!s[t]&&(e=!1);return e}window.Resources={load:function(e){e instanceof Array?e.forEach(function(e){t(e)}):t(e)},get:function(e){return s[e]},onReady:function(e){i.push(e)},isReady:n}}();var level=rand();function rand(){var i=3;return function(e){if(e)return i+=5,10+Math.floor(Math.random()*i);if(1400<player.bugIntervals){var t=Math.floor(20*Math.random())+i;return!1,t}var s=Math.floor(8*Math.random())+i;return!0,s}}var Enemy=function(){function s(e,t){_classCallCheck(this,s),this.x=e,this.y=t,this.right=e+40,this.left=e-30,this.bottom=t+35,this.top=t-15,this.sprite="images/enemy-bug.png",this.counter=level()}return _createClass(s,[{key:"update",value:function(e){if(this.x+=e*this.counter*10,530<this.x){var t=allEnemies.indexOf(this);allEnemies.splice(t,1)}this.bottom=this.y+35,this.right=this.x+40,this.left=this.x-30,ctx.drawImage(Resources.get(this.sprite),this.x,this.y)}},{key:"render",value:function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)}}]),s}(),Player=function(){function s(e,t){_classCallCheck(this,s),this.x=e,this.y=t,this.top=t-20,this.bottom=t+30,this.right=e+40,this.speedX=0,this.speedY=0,this.speed=1.5,this.bugIntervals=2e3,this.level=1,this.look={boy:"images/char-boy.png"},this.lives=3}return _createClass(s,[{key:"update",value:function(e,t){this.checkBoundary(),e?(this.x=202,this.y=417,this.speedX=0,this.speedY=0,this.bottom=this.y+30,this.right=this.x+40,this.top=this.y-20,ctx.drawImage(Resources.get(this.look.boy),this.x,this.y)):t?(this.x=202,this.y=417,this.speedX=0,this.speedY=0):(this.x+=this.speedX,this.y+=this.speedY,this.bottom=this.y+30,this.right=this.x+30,this.top=this.y-20,ctx.drawImage(Resources.get(this.look.boy),this.x,this.y));for(var s=this.lives;0<s;s--)ctx.drawImage(Resources.get("images/Heart.png"),490-80*s,570);this.drawLevel(),this.won(),this.gameOver()}},{key:"render",value:function(){ctx.drawImage(Resources.get(this.look.boy),this.x,this.y);for(var e=this.lives;0<e;e--)ctx.drawImage(Resources.get("images/Heart.png"),490-80*e,570);this.drawLive(),this.drawLevel()}},{key:"handleInput",value:function(e){"left"===e?this.speedX=-this.speed:"right"===e?this.speedX=this.speed:"up"===e?this.speedY=-this.speed:"down"===e&&(this.speedY=this.speed),this.update()}},{key:"removeInput",value:function(e){"left"===e?this.speedX=0:"right"===e?this.speedX=0:"up"===e?this.speedY=0:"down"===e&&(this.speedY=0),this.update()}},{key:"checkBoundary",value:function(){this.x+this.speedX<-14?(this.speedX=0,this.x=-12):450<this.right+this.speedX&&(this.speedX=0,this.x=420),this.y+this.speedY<-35?(this.speedY=0,this.y=-32):442<this.y+this.speedY&&(this.speedY=0,this.y=440)}},{key:"won",value:function(){this.y<=-10&&(this.x=202,this.y=417,this.speedX=0,this.speedY=0,ctx.drawImage(Resources.get(this.look.boy),this.x,this.y),this.bugSpeed())}},{key:"bugSpeed",value:function(){level(!0),player.bugIntervals-=200,player.level+=1,1400!==player.bugIntervals&&1e3!==player.bugIntervals&&800!==player.bugIntervals||(player.speed+=.2),allEnemies.forEach(function(e){e.counter=level()})}},{key:"drawLive",value:function(){ctx.font="30px Arial",ctx.fillText("Lives:",150,680),ctx.fillText(player.lives,230,680),0===this.lives&&this.drawEnd()}},{key:"drawLevel",value:function(){ctx.font="30px Arial",ctx.fillText("level: ",40,635),ctx.fillText(player.level,110,635)}},{key:"drawEnd",value:function(){ctx.fillText("Refresh page to play again",100,30)}},{key:"gameOver",value:function(){0===this.lives&&allEnemies.forEach(function(e){e.x=0,document.removeEventListener("keydown",onKeyDown),document.removeEventListener("keyup",onKeyUp)})}}]),s}(),player=new Player(202,417),allEnemies=[new Enemy(-80,50),new Enemy(-80,145),new Enemy(-80,235)],spawnBugs=setInterval(function(){allEnemies.push(new Enemy(-80,50),new Enemy(-80,145),new Enemy(-80,235))},player.bugIntervals);function checkCollison(){allEnemies.forEach(function(e){player.x<=e.right+30&&player.right>=e.left&&player.top<=e.bottom&&player.bottom>=e.top&&(player.lives-=1,player.update(!0))})}var onKeyDown=function(e){player.handleInput({37:"left",38:"up",39:"right",40:"down"}[e.keyCode])},onKeyUp=function(e){player.removeInput({37:"left",38:"up",39:"right",40:"down"}[e.keyCode])};document.addEventListener("keydown",onKeyDown),document.addEventListener("keyup",onKeyUp);var Engine=function(e){var t,s=e.document,i=e.window,n=s.createElement("canvas"),a=n.getContext("2d");function r(){var e=Date.now();!function(e){!function(t){allEnemies.forEach(function(e){e.update(t)}),player.update(),checkCollison(),0===player.lives&&player.drawEnd()}(e)}((e-t)/1e3),function(){var e,t,s=["images/water-block.png","images/stone-block.png","images/stone-block.png","images/stone-block.png","images/grass-block.png","images/grass-block.png"];for(a.clearRect(0,0,n.width,n.height),e=0;e<6;e++)for(t=0;t<5;t++)a.drawImage(Resources.get(s[e]),101*t,83*e);allEnemies.forEach(function(e){e.render()}),player.render()}(),t=e,i.requestAnimationFrame(r)}n.width=505,n.height=707,s.body.append(n),Resources.load(["images/stone-block.png","images/water-block.png","images/grass-block.png","images/enemy-bug.png","images/char-boy.png","images/Heart.png"]),Resources.onReady(function(){t=Date.now(),r()}),e.ctx=a}(void 0);